
@include <library.cqct>

@add_loadpath(loadpath()[0] + "/../test/libs");

@with_imports ( (f1, lib3.f2), lib4 ) { 
  @defloc f4() { printf("Running f4 from main!\n"); } 
  printf("In main\n"); 
  f1(); 
  f3(); 
  f4(); 
  printf("constant c1's value: %a\n",c1); 
}

@library(test) {
  @import( lib3 );
  @export( func );
  @define func() {
    f2();
  }
};

@with_imports( test ) {
  func();
}

@with_imports( subdir/sublib, (f2, subdir/sublib.fn1) ) {
  fn1();
  f2();
}

@with_imports( subdir/subdir2/sublib, (f2, subdir/subdir2/sublib.fn2) ) {
  fn2();
  f2();
}

x = "test";
y = "lib";
@dynamic_imports( x, y + "4" ) { func(); f3(); }
@dynamic_imports( "subdir"+"/"+"sublib" ) { fn1(); }
@dynamic_imports( "(f2, subdir/sublib.fn1)" ) { f2(); }


