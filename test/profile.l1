
@global c;
c=0;

foo = @lambda() {
	@profile("foo") {
		c++;
	}
};

printf("profiles:\n");
foreach(@lambda(k) {
	printf("%a: %a\n",k,profiles[k][0]);	
},tabkeys(profiles));

foo();

bar = @lambda() {
	@local x;

	x=2;
	@profile("bar") {
		@local x;
		x=12;
	};

	printf("X: %d\n",x);
};
bar();

baz = @lambda() {
	@local x;

	x=2;
	@profile() {
		@local x;
		x=12;
	};

	printf("X: %d\n",x);
};
baz();

printf("profiles:\n");
foreach(@lambda(k) {
	printf("%a: %d\n",k,profiles[k][0]);	
},tabkeys(profiles));

@global x;
for(x=0;x<1000;x++) {
	foo();
}

printf("profiles:\n");
foreach(@lambda(k) {
	printf("%a: %d\n",k,profiles[k][0]);	
},tabkeys(profiles));


