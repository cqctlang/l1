define dispatch args {
	@local arg, i;
	arg = listref(args, 0);
	printf("dispatch arg is %s, %d arguments\n", arg, length(args)-1);
	for(i = 1; i < length(args); i++)
		printf("%a\n", listref(args, i));
}

ns = c32le;
as = mkas(dispatch);
dom = mkdom(ns, as);
printf("isns(dom.names) = %d\n", isns(dom.names));
printf("isas(dom.as) = %d\n", isas(dom.as));

define test(o){
	o.foo(1, 2, 3);
	o.bar();
	fn = o.baz;
	fn(fn, fn);
	fn = o.dispatch;
	fn("yo!", fn, fn);
}
test(dom);
test(as);
