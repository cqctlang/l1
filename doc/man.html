<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<title>Cinquecento Manual</title>
<link rel="stylesheet" type="text/css" media="screen" href="reset.css"/>
<link rel="stylesheet" type="text/css" media="screen" href="styles.css"/>
</head>

<body>

<div id="content">

<a href="#sec:fnindex">Function Index</a>

<h3>Introduction</h3>

<p>
Cinquecento is a programming language designed to help
programmers examine the state of programs in execution,
particularly C programs.  The central feature of
Cinquecento is a first-class abstraction, called
a <em>domain</em>, that represents a program in
execution.  Cinquecento programs access the program
state represented by domains using types, operators,
and expressions of the C programming language.
</p>

<p>
Cinquecento is designed to be intuitive to programmers
who are already familiar with C and Scheme.  The syntax
and semantics of the Cinquecento types, values, and
expressions used to examine program state are nearly
identical to C; the main differences are
generalizations that allow multiple type and symbol
name spaces and different processor and compiler models
to coexist in a single Cinquecento program.  While the
syntax of Cinquecento in no way resembles Scheme, many
of the central features of Scheme --- dynamic typing,
lexical scope, proper tail recursion, first-class
functions, even continuations --- appear in Cinquecento
with similar generality.  C provides the data model;
Scheme provides the naming and control model.
</p>

<p>
In practice, Cinquecento must be coupled with a
facility for accessing the state of running programs.
A facility for accessing remotely executing Linux
processes accompanies our distribution.  However, the
role of Cinquecento is to provide a uniform,
programmable interface to the program state exposed by
the variety of such facilities.  This manual focuses on
these generic features of the language, which are
necessary for all users, at the expense of concrete
examples on real programs for a specific environment.
A separate document fills in the details for Linux.
</p>

<h3>Preliminaries</h3>

<p>
Here is how to print something:
</p>

<div id="code">
<pre>
; printf("hello, world!");
hello, world
</pre>
</div>

<p>
Our Cinquecento implementation can be used
interactively, like most scripting languages.  In this
manual, <tt>;</tt> is the input prompt at which a
Cinquecento form to be evaluated is entered.  The
result of the evaluation is printed on the following
line.  We will occasionally omit some or all output
when it detracts from the main point.
</p>

<p>
Input can also be read from a file.  Suppose
<tt>filename</tt> contains the line <tt>printf("hello,
world!");</tt>.  Then:
</p>

<div id="code">
<pre>
; @include "filename"
hello, world
</pre>
</div>

<p>
When reading input source, Cinquecento replaces any
occurrence of the <tt>@include</tt> form with the
contents of the named file.  They may appear anywhere
in input.
</p>

<p>
Comment syntax follows C.  Input enclosed in
<tt>/*</tt> <tt>*/</tt> is a comment.  Input between
<tt>//</tt> and the next newline character is also a
comment.
</p>

<h3>Cinquecento Types</h3>

<p>
Cinquecento defines several types of values.  Every
value in Cinquecento has exactly one type.
</p>

<p>
The types special to Cinquecento are <em>cvalue</em>,
<em>ctype</em>, <em>domain</em>, <em>address
space</em>, and <em>name space</em>.  In certain
(usually invisible) contexts, address spaces are
indexed by values of type <em>address</em> and
<em>range</em>.
</p>

<p>
Other basic types include <em>string</em>,
<em>procedure</em>, and <em>file descriptor</em>.

<p>
There are also several container types for storing
values of any type: <em>list</em>, <em>vector</em>, and
<em>table</em>.
</p>

<p>
The special value, <tt>nil</tt>, is not a member of any
other type or equal to any other value.
</p>

<p>
The <em>undefined</em> value uninitialized variables
and containers bindings and containers.  There is no
corresponding literal.
</p>

<p>
For each type there is a predicate to test whether a
value belongs to the type.  The predicates are
<tt>isctype</tt>, <tt>isdom</tt>, <tt>isas</tt>,
<tt>isns</tt>, <tt>isrange</tt>, <tt>isaddr</tt>,
<tt>isstr</tt>, <tt>isprocedure</tt>, <tt>isfd</tt>
(file descriptor), <tt>isnil</tt>, <tt>islist</tt>,
<tt>isvec</tt>, <tt>istable</tt>, <tt>isnil</tt>, and
<tt>isundefined</tt>.
</p>

<p>
There are no explict numeric types.  In Cinquecento,
all arithmetic is performed using C operators over
values of type cvalue.
</p>

<h3>Concepts</h3>

<p>
The syntax and types of Cinquecento are used to
construct and interact with an abstract model of a
program in execution.  This section describes the
concepts and terminology underlying this model.
</p>

<p>
A program in execution reads and writes values stored
in its memory.  This memory is represented in
Cinquecento by an <em>address space</em>.  An address
space is any mapping from byte addresses to byte
values.  Address spaces are dynamic: the value of a
byte at a given address may change over time as it is
updated by the program.  Moreover, not all valid byte
addresses are necessarily mapped by a given address
space; typically, an address space maps a small number
(dozens) of large, contiguous address ranges (each
spanning megabytes), and this mapping may change over
time.
</p>

<p>
For example, the address space of a typical Unix or
Windows program contains mappings for the program text,
data, stack, and heap.  Only the contents of the text
mapping are likely to remain unchanged during execution.
New mappings may be added over time as the program
loads dynamic libraries or as its demand for stack and
heap space increases.
</p>

<p>
The address space provides a raw, untyped view of
program memory.  A more abstract, symbolic view of
memory is provided by the types associated with values
stored in memory.  This association comes from the type
and variable definitions made in the source code of the
program.  The type system used by Cinquecento is based,
tightly, on the type system of the C programming
language.
</p>

<p>
Programs written in languages other than C may have, at
source level, type that are wildly different from those
of C.  However, at the level of program memory, these
types much eventually be reduced to a simple set of
primitive values, which often are easily modeled as C
types, particularly if the underlying implementation of
the language is written in C.
</p>

<p>
</p>


<h3>Domains</h3>

<p>
The most important type in Cinquecento is the
<em>domain</em>.  A domain is a representation of the
state of a C program in execution suitable for
examining and modifying program variables and data
structures.  In Cinquecento these interactions are
expressed using ordinary C expressions; a more precise
definition of a domain is that it represents a context
in which C expressions can be evaluated.  This context
includes definitions of the types, variables, and
constants referenced, perhaps implicitly, by a C
expression.  It also includes the storage to which
operations that reference memory are directed.
</p>

<p>
The structure of a Cinquecento domain has two parts,
represented by two Cinquecento values.  First, the
<em>name space</em> is symbolic information about the
program, the names and definitions of types and
variables as defined in the source code of the program.
Second, the <em>address space</em> is the uninterpreted
memory image of a running instance of the program, a
mapping from program addresses to the corresponding
contents of memory.  A Cinquecento domain is a
projection of the symbolic view of memory defined by
the name space over memory image defined by the address
space.
</p>

<p>
Domains, name spaces, and address spaces are
first-class values in Cinquecento.  Syntax forms allow
new name spaces to be defined from extended form of C
declaration syntax.  Both name spaces and address
spaces can also be constructed from user-defined
functions.
</p>

<h3>C Values</h3>

<p>
Values corresponding to values in C programs are represented
with the Cinquecento type <span class="type">cvalue</span>.
</p>

<p>
In addition to its value, each cvalue has an associated
domain and ctype.  The domain is a generally a
reference to the domain from which the value was
generated.  For example, the domain associated with a
cvalue that represents a C pointers provides a reference




</p>

<h3>C Types</h3>

<p>The Cinquecento type <em>ctype</em> represents types
defined in C programs.  Cinquecento subdivides the set
of types that can be defined in C into several
categories.  The main categories are: the <tt>void</tt>
type, the base arithmetic types (<tt>char</tt>,
<tt>int</tt>, <tt>unsigned long</tt>, <em>etc</em>),
pointers, arrays, aggregates (<tt>struct</tt> and
<tt>union</tt>), functions, enumerations, and
<tt>typedef</tt>s.  In addition, Cinquecento also has
separate categories for bitfields, enumeration
constants, and undefined types.
</p>

<p>
Each type used by a C program is represented in
Cinquecento as a combination of instances of these
categories.  Cinquecento has a distinct ctype
constructor for each category, a predicate to test a
ctype instance for membership in the category, and
accessors for category-dependent attributes such as the
fields of an aggregate and the pointed-to type of a
pointer.
</p>

<p>
Cinquecento ctypes represent both C type names and C
type definitions.  Type names are the syntactic
constructions, such as <tt>int*</tt>, that can appear
in C declarations, or as operands to type operations
such as <tt>sizeof</tt> and explicit casts.
Type definitions specify the encoding in memory of the
value of a C type.  For base types, this specification
includes the number of bytes that represent the value
and how the bytes are to be interpreted (e.g., big- or
little-endian order).  For pointer types, it includes
the size and representation of the pointer value
memory.  For aggregates, it includes the offset from
the beginning of the aggregate to each field and
the overall size of the aggregate.
</p>

<p>
The distinction between type name and definition
matters when the same type name different domains have
types with the same name.  For example, the type name
<tt>int*</tt> always corresponds to the type
pointer-to-<tt>int</tt>, but there are many possible
definitions.  One domain can define it to be a 64-bit
address of a 64-bit integer encoded in big-endian
order, while another may be define it be a 32-bit
address of a 32-bit integer encoded in little-endian
order.
</p>

<div id="table">
<table>
<tr>
<th>Type category</th>
<th>Name properties</th>
<th>Definition properties</th>
</tr>

<tr>
<td>
Arithmetic
</td>
<td>
Name (<tt>int</tt>, ...)
</td>
<td>
Name (<tt>int</tt>, ...)<br />
Size and encoding
</td>
</tr>

<tr>
<td>
Aggregate
</td>
<td>
Tag
</td>
<td>
Tag (optional)<br />
Size<br />
Fields
</td>
</tr>

<tr>
<td>
Array
</td>
<td>
Element type<br />
Count (optional)
</td>
<td>
Element type<br />
Count (optional)
</td>
</tr>

<tr>
<td>
Function
</td>
<td>
Return type<br />
Parameters
</td>
<td>
Return type<br />
Parameters
</td>
</tr>

<tr>
<td>
Enumeration
</td>
<td>
Tag
</td>
<td>
Tag (optional)<br />
Size and encoding (optional)<br />
Constants (optional)
</td>
</tr>

<tr>
<td>
Typedef
</td>
<td>
Identifier<br />
</td>
<td>
Identifier<br />
Aliased type
</td>
</tr>

<tr>
<td>
Pointer
</td>
<td>
Pointed-to type
</td>
<td>
Pointed-to type<br />
Size and encoding
</td>
</tr>

<tr>
<td>
Void
</td>
<td>
None
</td>
<td>
None
</td>
</tr>

</table>
</div>

<p>
Type names and type definitions are first-class
Cinquecento values represented by the type
<em>ctype</em>.  Whether a ctype value represents a
type name or a type definition depends on its
properties.  Usually it is clear from the context in
which the ctype was produced.
</p>

<p>
There is a ctype constructor for each type category.
For a given category, the same constructor can generate
either a type name or a type definition, depending on
the arguments.  The constructors are:
</p>

<div id="table">
<table>
<tr>
<th>Type category</th>
<th>Name constructor</th>
<th>Definition constructor</th>
</tr>
<tr>
<td>
Arithmetic
</td>
<td>
<div id="symbols">
mkctype_char()<br />
mkctype_short()<br />
mkctype_int()<br />
mkctype_long()<br />
mkctype_vlong()<br />
mkctype_uchar()<br />
mkctype_ushort()<br />
mkctype_uint()<br />
mkctype_ulong()<br />
mkctype_uvlong()<br />
mkctype_float()<br />
mkctype_double()<br />
mkctype_ldouble()
</div>
</td>
<td>
<div id="symbols">
<em>n/a</em>
</div>
</td>
</tr>

<tr>
<td>
Aggregate
</td>
<td>
<div id="symbols">
mkctype_struct(<em>tag</em>)<br />
mkctype_union(<em>tag</em>)
</div>
</td>
<td>
<div id="symbols">
mkctype_struct(<em>tag</em>, <em>fields</em>, <em>sz</em>)<br />
mkctype_union(<em>tag</em>, <em>fields</em>, <em>sz</em>)<br />
</div>
</td>
</tr>

<tr>
<td>
Array
</td>
<td>
<div id="symbols">
mkctype_array(<em>ctype</em>, <em>count</em>)<br />
</div>
</td>
<td>
<div id="symbols">
mkctype_array(<em>ctype</em>, <em>count</em>)<br />
</div>
</td>
</tr>

<tr>
<td>
Function
</td>
<td>
<div id="symbols">
mkctype_fn(<em>ctype</em>, <em>params</em>)
</div>
</td>
<td>
<div id="symbols">
mkctype_fn(<em>ctype</em>, <em>params</em>)
</div>
</td>
</tr>

<tr>
<td>
Enumeration
</td>
<td>
<div id="symbols">
mkctype_enum(<em>tag</em>)
</div>
</td>
<td>
<div id="symbols">
mkctype_enum(<em>tag</em>, <em>ctype</em>, <em>consts</em>)
</div>
</td>
</tr>

<tr>
<td>
Typedef
</td>
<td>
<div id="symbols">
mkctype_typedef(<em>id</em>)
</div>
</td>
<td>
<div id="symbols">
mkctype_typedef(<em>id</em>, <em>ctype</em>)
</div>
</td>
</tr>

<tr>
<td>
Pointer
</td>
<td>
<div id="symbols">
mkctype_ptr(<em>ctype</em>)
</div id="symbols">
</td>
<td>
<div id="symbols">
mkctype_ptr(<em>ctype</em>, <em>repctype</em>)
</div>
</td>
</tr>

<tr>
<td>
Void
</td>
<td>
<div id="symbols">
mkctype_void()
</div>
</td>
<td>
<div id="symbols">
mkctype_void()
</div>
</td>
</tr>

<tr>
<td>
Typedef
</td>
<td>
<div id="symbols">
mkctype_typedef(<em>id</em>)
</div>
</td>
<td>
<div id="symbols">
mkctype_typedef(<em>id</em>,<em>ctype</em>)
</div>
</td>
</tr>

<tr>
<td>
Bitfield
</td>
<td>
<div id="symbols">
mkctype_bitfield(<em>ctype</em>,<em>width</em>,<em>off</em>)
</div>
</td>
<td>
<div id="symbols">
mkctype_bitfield(<em>ctype</em>,<em>width</em>,<em>off</em>)
</div>
</td>
</tr>

<tr>
<td>
Enum constant
</td>
<td>
<div id="symbols">
mkctype_const(<em>ctype</em>)
</div>
</td>
<td>
<div id="symbols">
mkctype_const(<em>ctype</em>)
</div>
</td>
</tr>


</table>
</div>

<p>
Arguments corresponding to optional properties may be
<tt>nil</tt>.

<p>
The <em><tt>fields</tt></em> parameter is a vector of
field definitions.  Each field definition is a vector
of four elements:
</p>

<div id="inset">
<p>
<tt>vector(<em>ctype</em>, <em>id</em>, <em>offset</em>, <em>width</em>);</tt>
</p>
</div>

<div id="noindent">
<p>
where <em><tt>ctype</tt></em> is the type of the field,
and <em><tt>id</tt></em> is the name of the field.  If
the field is a bitfield, then <em><tt>width</tt></em>
is the width in bits of the field and
<em><tt>offset</tt></em> is the bit offset from the
beginning of the aggregate to the start of the
bitfield.  Otherwise, <em><tt>width</tt></em> is
<tt>nil</tt>, and <em><tt>offset</tt></em> is the
<em>byte</em> offset from the beginning of the
aggregate to the start of the field.

</p>
</div>

<p>
The <em><tt>params</tt></em> parameter is a vector of
function parameter definitions, ordered by parameter
position.  Each parameter definition is a vector of two
elements:
</p>

<div id="inset">
<p>
<tt>vector(<em>ctype</em>, <em>id</em>);</tt>
</p>
</div>

<div id="noindent">
<p>
where <em><tt>ctype</tt></em> is the type of the
parameter, and <em><tt>id</tt></em> is the name of the
parameter or <tt>nil</tt>.
</p>
</div>

<p>
The <em><tt>consts</tt></em> parameter is a vector of
enumeration constant definitions.  Each constant
definition is a vector of two elements:
</p>

<div id="inset">
<p>
<tt>vector(<em>id</em>, <em>value</em>);</tt>
</p>
</div>

<div id="noindent">
<p>
The exact behavior of <tt>mkctype_enum</tt> remains a mystery.
</p>
</div>

<p>
Part of the role of a Cinquecento name space is to
define a set of C types.  This is implemented by
defining a function, conventionally
called <tt>looktype</tt>, that maps type names to type
definitions.  The argument to this function is a ctype
that <tt>looktype</tt> treats as a type name.  It
returns the corresponding definition for that name,
or <tt>nil</tt> if there is no definition.
</p>

<p>
Most name spaces are defined by the <tt>@names</tt>
operator, which translates C declarations into a
definition of a name space.  The name space
constructor <tt>mkns</tt> provides an alternate way to
define a name space.  The argument to mkns is a table,
conventionally named <tt>typetab</tt>, that maps type
names to type definitions.
</p>

<p>
Unlike <tt>looktype</tt>, the type names to
which <tt>typetab</tt> maps names do not need to be
fully defined type names.
</p>

<h3>Standard address spaces</h3>

<p>
An address space represents random access,
byte-addressed storage.  Cinquecento provides functions
to construct address spaces whose underlying backing
storage comes from files, strings, or system-provided
memory.
</p>

<p>
Several built-in functions create new address spaces
with specific forms of backing storage.
</p>

<p>
The function <tt>mknas()</tt> returns a null address
space that has no backing storage.  An attempt to read
or write any location in this address space draws an
error.  This address space is used to construct domains
that act solely as sources for types and symbols; for
example, the literal domain is backed by a null address
space.
</p>

<p>
The function <tt>mksas(<em>str</em>)</tt> creates an
address base backed by the string <em>str</em>.  The
memory associated with the string is shared with the
address space, so that an update made to either the
string or the address space will be reflected in the
other.
</p>

<p>
The function <tt>mkzas(<em>len</em>)</tt> creates a
zero-filled address space backed by
<tt><em>len</em></tt> bytes of unshared, cleared
memory supplied by the system.
</p>

<h3>Custom address spaces</h3>

<p>
Cinquecento allows programs to construct an address space
with a custom implementation of the underlying backing
storage.
</p>

<p>A custom implementation requires the program to
define three functions: <tt><em>map</em></tt>,
<tt><em>get</em></tt>, and <tt><em>put</em></tt>.
</p>

<p>
These functions receive and return values of the
Cinquecento type <em>range</em>.  The range type
represents a contiguous span of locations in an address
space.  A range value is constructed by the function
<tt>mkrange(<em>beg</em>,<em>len</em>)</tt>, where
<tt><em>beg</em></tt> is the non-negative start address
of the range and <tt><em>len</em></tt> is the positive
number of bytes in the range; both are cvalues.  Empty
ranges are invalid.  The functions
<tt>rangebeg(<em>range</em>)</tt> and
<tt>rangelen(<em>range</em>)</tt> return the start
address and byte count from a range as cvalues.
</p>

<p>
<tt><em>Map</em></tt> takes no arguments and returns a
description of the <em>mapped ranges</em> of the
address space as a vector of range values.  Each
element of the vector must be a range describing a
maximal contiguous span of locations backed by the
address space.  The vector must be sorted in ascending
order by start address.  The ranges must not overlap.
</p>

<p>
<tt><em>Get</em></tt> takes a range argument and
returns a string.  The string should contain the
contents of storage corresponding to the range.
</p>

<p>
<tt><em>Put</em></tt> takes two arguments, a range and
a string, and returns <tt>nil</tt>.
<tt><em>Put</em></tt> should replace the contents of
storage corresponding to the range with the contents of
the string, ignoring the trailing portion of the string
if it is longer than the range.
</p>

<p>
A call to <tt>fault()</tt> in the dynamic extent of a
call to <tt><em>get</em></tt> or <tt><em>put</em></tt>
will cause a toplevel memory access fault error to be
raised in the context of the call.  Implementations of
<tt><em>get</em></tt> and <tt><em>put</em></tt> are
expected to call <tt>fault</tt> to signal invalid
arguments and related exceptions.
</p>

<p>
The function <tt>mkas(<em>dispatch</em>)</tt>
constructs a custom address space.  Dispatch is a
program-defined variable arity function that
encapsulates the <tt><em>map</em></tt>,
<tt><em>get</em></tt>, and <tt><em>put</em></tt>
functions.  The first argument to dispatch is a string
whose value is the name of the function to be called;
dispatch must apply the corresponding function to the
remaining arguments.
</p>

<p>
Ordinarily the functions represented by
<em>dispatch</em> are implicitly invoked by the
Cinquecento implementation during evaluation of C
expressions that involve storage access operations
(such as dereferencing a pointer).  However, programs
may directly invoked these functions by name using an
overloaded form of the C binary dot operator:
<div id="code">
<pre>
; as.get(mkrange(0,1024));
</pre>
</div>
</p>

<p>
When the left operand of a dot expression is an address
space, the result of the expression is a variable arity
function that, when called, calls the dispatch function
of the address space.  The arguments it passes to
dispatch are, first, the identifier appearing as the
right operand to the dot expression as a string,
followed by the arguments to the call.
</p>

<p>
In addition, if the right operand is the identifier
<tt>dispatch</tt>, then the result of the expression is
simply the dispatch function of the address space,
instead of the curried version described above.
For example, the above call to <tt>get</tt> is equivalent to:
<div id="code">
<pre>
; as.dispatch("get",mkrange(0,1024));
</pre>
</div>
</p>

<p>
As a syntactic convenience, the left operand to the dot
operator can also be a domain, in which case the same
operation is performed on the underlying address space.
</p>

<p>
The address spaces returned by the standard address
space constructors all implement a dispatch function
that can be accessed with the dot operator in the same
way as a custom address space.
</p>

<p>
The dot operator on address spaces will accept any
valid identifier (not just <tt>map</tt>, <tt>get</tt>,
<tt>put</tt>, and <tt>dispatch</tt>), providing a way
for programs to extend the standard address space
interface with additional custom functions.  This
feature can be used, for example, to associate a
function for setting breakpoints with an address space.
</p>

<p>
The Cinquecento address type exists to support the
implementation of operations like setting a breakpoint
on a solitary address.  The function
<tt>mkaddr(<em>val</em>)</tt> constructs an address
value from the cvalue <tt><em>val</em></tt>.  The
function <tt>addrval(<em>addr</em>)</tt> returns the
cvalue used to construct the address
<tt><em>addr</em></tt>.
</p>

<h3>Containers</h3>

<p>
Cinquecento supports three built-in container types:
lists, vectors, and tables.
</p>

<p>
Several functions operate on any type of container.
</p>

<div class="docitem" id="fn:length">
<div class="proto">
<div class="function">
<span class="id">length(<span class="arg">container</span>)</span>
</div>
<div class="param">
<span class="arg">container</span>: <span class="type">list</span>, <span class="type">vector</span>, or <span class="type">table</span>
</div>
<div class="returns">
<span class="type">cvalue</span>
</div>
</div>
<div class="desc">
Returns the number of items stored in 
<span class="arg">container</span>.
</div>
</div>

<div class="docitem" id="fn:copy">
<div class="proto">
<div class="function">
<span class="id">copy(<span class="arg">container</span>)</span>
</div>
<div class="param">
<span class="arg">container</span>: <span class="type">list</span>, <span class="type">vector</span>, or <span class="type">table</span>
</div>
<div class="returns">
<span class="type">whatever container is</span>
</div>
</div>
<div class="desc">
Returns a shallow copy of <span class="arg">container</span>.
</div>
</div>

<div class="docitem" id="fn:foreach">
<div class="proto">
<div class="function">
<span class="id">foreach(<span class="arg">fn</span>,<span class="arg">container</span>)</span>
</div>
<div class="param">
<span class="arg">fn</span>: <span class="type">procedure</span>
</div>
<div class="param">
<span class="arg">container</span>: <span class="type">list</span>, <span class="type">vector</span>, or <span class="type">table</span>
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">

Calls <span class="arg">fn</span> on each item in <span
class="arg">container</span>.  For lists and vectors,
<span class="id">foreach</span> visits each item in
sequential order, calling <span class="arg">fn</span>
with the item as the sole argument.  For tables, <span
class="id">foreach</span> visits each key/value pair in
unspecified order, calling <span class="arg">fn</span>
with the key and value, in that order, as separate
arguments.  </div> </div>

<h3>Lists</h3>

<p>
Lists are variable-length ordered collections, possibly
empty.  Lists are mutable, allowing items to be added
or deleted from any position, and contiguously indexed
from position 0.
</p>

<div class="docitem" id="fn:list">
<div class="proto">
<div class="function">
<span class="id">list(<span class="arg">value</span>, ...)</span>
</div>
<div class="param">
<span class="arg">value</span>: <span class="type">any type</span>
</div>
<div class="returns">
<span class="type">list</span>
</div>
</div>
<div class="desc">
Constructs a new list containing the zero or more values passed as arguments.
The values are stored in argument order.
</div>
</div>

<div class="docitem">
<div class="proto">
<div class="syntax">
<span class="id">[ <span class="arg">value</span>, ... ]</span>
</div>
<div class="param">
<span class="arg">value</span>: <span class="type">any type</span>
</div>
<div class="returns">
<span class="type">list</span>
</div>
</div>
<div class="desc">
The syntax <span class="id">[...]</span> constructs a
new list containing the zero or more values enclosed in the
braces.  It is equivalent to calling <span
class="id">list</span> on the enclosed values.
</div>
</div>

<div class="docitem" id="fn:isempty">
<div class="proto">
<div class="function">
<span class="id">isempty(<span class="arg">list</span>)</span>
</div>
<div class="param">
<span class="arg">list</span>: <span class="type">list</span>
</div>
<div class="returns">
<span class="type">cvalue</span>
</div>
</div>
<div class="desc">

Returns <span class="val">1</span> if <span
class="arg">list</span> is empty, <span class="val">0</span> otherwise.

</div>
</div>

<div class="docitem" id="fn:head">
<div class="proto">
<div class="function">
<span class="id">head(<span class="arg">list</span>)</span>
</div>
<div class="param">
<span class="arg">list</span>: <span class="type">list</span>
</div>
<div class="returns">
<span class="type">depends on contents of <span class="arg">list</span></span>
</div>
</div>
<div class="desc">
Returns the first element of <span class="arg">list</span>.
</div>
</div>

<div class="docitem" id="fn:tail">
<div class="proto">
<div class="function">
<span class="id">tail(<span class="arg">list</span>)</span>
</div>
<div class="param">
<span class="arg">list</span>: <span class="type">list</span>
</div>
<div class="returns">
<span class="type">list</span>
</div>
</div>
<div class="desc">
Returns a copy of <span class="arg">list</span> with the first element removed.
</div>
</div>


<div class="docitem" id="fn:listref">
<div class="proto">
<div class="function">
<span class="id">listref(<span class="arg">list</span>,<span class="arg">idx</span>)</span>
</div>
<div class="param">
<span class="arg">list</span>: <span class="type">list</span>
</div>
<div class="param">
<span class="arg">idx</span>: <span class="type">cvalue</span>
</div>
<div class="returns">
<span class="type">depends on contents of <span class="arg">list</span></span>
</div>
</div>
<div class="desc">
Returns the item stored at position <span class="arg">idx</span> in
<span class="arg">list</span>.
</div>
</div>

<div class="docitem" id="listset">
<div class="proto">
<div class="function">
<span class="id">listset(<span class="arg">list</span>,<span class="arg">idx</span>,<span class="arg">value</span>)</span>
</div>
<div class="param">
<span class="arg">list</span>: <span class="type">list</span>
</div>
<div class="param">
<span class="arg">idx</span>: <span class="type">cvalue</span>
</div>
<div class="param">
<span class="arg">value</span>: <span class="type">any type</span>
</div>
<div class="returns">
<span class="type">list</span>
</div>
</div>
<div class="desc">
Replaces the item at position <span
class="arg">idx</span> in <span
class="type">list</span> with <span
class="arg">value</span>.  It is an error if <span
class="type">list</span> does not contain more than
<span class="arg">idx</span> items.  Returns the updated list.
</div>
</div>

<div class="docitem" id="fn:listins">
<div class="proto">
<div class="function">
<span class="id">listins(<span class="arg">list</span>,<span class="arg">idx</span>,<span class="arg">value</span>)</span>
</div>
<div class="param">
<span class="arg">list</span>: <span class="type">list</span>
</div>
<div class="param">
<span class="arg">idx</span>: <span class="type">cvalue</span>
</div>
<div class="param">
<span class="arg">value</span>: <span class="type">any type</span>
</div>
<div class="returns">
<span class="type">list</span>
</div>
</div>
<div class="desc">
Inserts <span class="arg">value</span>  at position <span
class="arg">idx</span> in <span
class="type">list</span>.  The elements at position <span
class="arg">idx</span> and higher, if any, are shifted up one position.
It is an error if <span
class="type">list</span> does not contain more than
<span class="arg">idx-1</span> items.  Returns the updated list.
</div>
</div>

<div class="docitem" id="fn:listdel">
<div class="proto">
<div class="function">
<span class="id">listdel(<span class="arg">list</span>,<span class="arg">idx</span>)</span>
</div>
<div class="param">
<span class="arg">list</span>: <span class="type">list</span>
</div>
<div class="param">
<span class="arg">idx</span>: <span class="type">cvalue</span>
</div>
<div class="returns">
<span class="type">list</span>
</div>
</div>
<div class="desc">
Deletes the item at position <span
class="arg">idx</span> in <span
class="type">list</span>.  The elements at higher
positions, if any, are shifted down one position.
Returns the updated list.
</div>
</div>

<div class="docitem" id="fn:append">
<div class="proto">
<div class="function">
<span class="id">append(<span class="arg">list</span>,<span class="arg">value</span>)</span>
</div>
<div class="param">
<span class="arg">list</span>: <span class="type">list</span>
</div>
<div class="param">
<span class="arg">value</span>: <span class="type">any type</span>
</div>
<div class="returns">
<span class="type">list</span>
</div>
</div>
<div class="desc">
Inserts <span class="arg">value</span> at the end of
<span class="type">list</span>.  Returns the updated list.
</div>
</div>

<div class="docitem" id="fn:push">
<div class="proto">
<div class="function">
<span class="id">push(<span class="arg">list</span>,<span class="arg">value</span>)</span>
</div>
<div class="param">
<span class="arg">list</span>: <span class="type">list</span>
</div>
<div class="param">
<span class="arg">value</span>: <span class="type">any type</span>
</div>
<div class="returns">
<span class="type">list</span>
</div>
</div>
<div class="desc">
Inserts <span class="arg">value</span> at the beginning of
<span class="type">list</span>, shifting all other elements up one position.
Returns the updated list.
</div>
</div>

<div class="docitem" id="fn:pop">
<div class="proto">
<div class="function">
<span class="id">pop(<span class="arg">list</span>)</span>
</div>
<div class="param">
<span class="arg">list</span>: <span class="type">list</span>
</div>
<div class="param">
<span class="arg">value</span>: <span class="type">any type</span>
</div>
<div class="returns">
<span class="type">depends on contents of <span class="arg">list</span></span>
</div>
</div>
<div class="desc">
Removes and returns the first element of <span class="type">list</span>,
shifting any remaining elements down one position.
</div>
</div>

<div class="docitem" id="fn:reverse">
<div class="proto">
<div class="function">
<span class="id">reverse(<span class="arg">list</span>)</span>
</div>
<div class="param">
<span class="arg">list</span>: <span class="type">list</span>
</div>
<div class="returns">
<span class="type">list</span>
</div>
</div>
<div class="desc">
Returns a new list containing the elements of <span class="arg">list</span> in reverse order.
</div>
</div>

<h3>Vectors</h3>

<p>
Vectors are fixed-length ordered collections, possibly
empty.  Vectors are mutable, allowing items to be
changed at any position, and contiguously indexed from
position 0.
</p>

<div class="docitem" id="fn:mkvec">
<div class="proto">
<div class="function">
<span class="id">mkvec(<span class="arg">len</span>)</span>
</div>
<div class="param">
<span class="arg">len</span>: <span class="type">cvalue</span>
</div>
<div class="returns">
<span class="type">vector</span>
</div>
</div>
<div class="desc">
Constructs a new vector of size <span class="arg">len</span>.
Each element is initialized to <span class="val">nil</span>.
</div>
</div>

<div class="docitem" id="fn:vector">
<div class="proto">
<div class="function">
<span class="id">vector(<span class="arg">value</span>, ...)</span>
</div>
<div class="param">
<span class="arg">value</span>: <span class="type">any type</span>
</div>
<div class="returns">
<span class="type">vector</span>
</div>
</div>
<div class="desc">
Constructs a new vector containing the zero or more values passed as arguments.
The values are stored in argument order.  The size of the vector is equal to the number of arguments.
</div>
</div>

<div class="docitem" id="fn:veclen">
<div class="proto">
<div class="function">
<span class="id">veclen(<span class="arg">vec</span>)</span>
</div>
<div class="param">
<span class="arg">vec</span>: <span class="type">vector</span>
</div>
<div class="returns">
<span class="type">cvalue</span>
</div>
</div>
<div class="desc">
Returns the number of items in <span class="arg">vec</span>.
Equivalent to <tt>length(<span class="arg">vec</span>)</tt>.
</div>
</div>


<div class="docitem" id="fn:vecref">
<div class="proto">
<div class="function">
<span class="id">vecref(<span class="arg">vec</span>,<span class="arg">idx</span>)</span>
</div>
<div class="param">
<span class="arg">vec</span>: <span class="type">vector</span>
</div>
<div class="param">
<span class="arg">idx</span>: <span class="type">cvalue</span>
</div>
<div class="returns">
<span class="type">depends on contents of <span class="arg">vec</span></span>
</div>
</div>
<div class="desc">
Returns the item stored at position <span class="arg">idx</span> in
<span class="arg">vec</span>.
</div>
</div>

<div class="docitem" id="fn:vecset">
<div class="proto">
<div class="function">
<span class="id">vecset(<span class="arg">vec</span>,<span class="arg">idx</span>,<span class="arg">value</span>)</span>
</div>
<div class="param">
<span class="arg">vec</span>: <span class="type">vector</span>
</div>
<div class="param">
<span class="arg">idx</span>: <span class="type">cvalue</span>
</div>
<div class="param">
<span class="arg">value</span>: <span class="type">any type</span>
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
Replaces the item at position <span
class="arg">idx</span> in <span
class="type">vec</span> with <span
class="arg">value</span>.  It is an error if <span
class="type">vec</span> does not contain more than
<span class="arg">idx</span> items.
</div>
</div>

<h3>Tables</h3>

<p>
Tables store key/value pairs.  Keys and values may be
any type of Cinquecento value other than <span
class="type">nil</span>.
</p>

<div class="docitem" id="fn:mktab">
<div class="proto">
<div class="function">
<span class="id">mktab()</span>
</div>
<div class="returns">
<span class="type">table</span>
</div>
</div>
<div class="desc">
Creates and returns a new, empty table.
</div>
</div>


<div class="docitem" id="fn:tabinsert">
<div class="proto">
<div class="function">
<span class="id">tabinsert(<span class="arg">tab</span>,<span class="arg">key</span>,<span class="arg">value</span>)</span>
</div>
<div class="param">
<span class="arg">tab</span>: <span class="type">table</span>
</div>
<div class="param">
<span class="arg">key</span>: <span class="type">any type</span>
</div>
<div class="param">
<span class="arg">value</span>: <span class="type">any type</span>
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
Inserts the pair <span class="arg">key</span>/<span
class="arg">value</span> into <span
class="arg">tab</span>.  Any previous entry for
the same <span class="arg">key</span> is removed.
</div>
</div>

<div class="docitem" id="fn:tablook">
<div class="proto">
<div class="function">
<span class="id">tablook(<span class="arg">tab</span>,<span class="arg">key</span>)</span>
</div>
<div class="param">
<span class="arg">tab</span>: <span class="type">table</span>
</div>
<div class="param">
<span class="arg">key</span>: <span class="type">any type</span>
</div>
<div class="returns">
<span class="type">depends on the contents of <span class="arg">tab</span></span>
</div>
</div>
<div class="desc">
Searches <span class="arg">tab</span> for a pair whose
key is <span class="arg">key</span> and returns the
associated value.  Returns <span class="val">nil</span>
if <span class="arg">tab</span> has no such pair.

</div>
</div>

<div class="docitem" id="fn:tabdelete">
<div class="proto">
<div class="function">
<span class="id">tabdelete(<span class="arg">tab</span>,<span class="arg">key</span>)</span>
</div>
<div class="param">
<span class="arg">tab</span>: <span class="type">table</span>
</div>
<div class="param">
<span class="arg">key</span>: <span class="type">any type</span>
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
Deletes the pair with key <span class="arg">key</span>
from <span class="arg">tab</span>, if it exists.
</div>
</div>

<div class="docitem" id="fn:tabkeys">
<div class="proto">
<div class="function">
<span class="id">tabkeys(<span class="arg">tab</span>)
</div>
<div class="param">
<span class="arg">tab</span>: <span class="type">table</span>
</div>
<div class="returns">
<span class="type">vector</span>
</div>
</div>
<div class="desc">
Returns a vector containing all keys in
<span class="arg">tab</span>.
</div>
</div>

<div class="docitem" id="fn:tabvals">
<div class="proto">
<div class="function">
<span class="id">tabvals(<span class="arg">tab</span>)
</div>
<div class="param">
<span class="arg">tab</span>: <span class="type">table</span>
</div>
<div class="returns">
<span class="type">vector</span>
</div>
</div>
<div class="desc">
Returns a vector containing all values in
<span class="arg">tab</span>.</div>
</div>

<div class="docitem" id="fn:tabenum">
<div class="proto">
<div class="function">
<span class="id">tabenum(<span class="arg">tab</span>)
</div>
<div class="param">
<span class="arg">tab</span>: <span class="type">table</span>
</div>
<div class="returns">
<span class="type">vector</span>
</div>
</div>
<div class="desc">
Returns a vector containing all keys and values in
<span class="arg">tab</span>.  The length of the
returned vector is twice the number of pairs in <span
class="arg">tab</span>.  The first half of the vector
contains the keys of <span class="arg">tab</span>; the
second half contains, in corresponding order,  the values.
</div>
</div>


<h3>Strings</h3>

<p>
The Cinquecento string type represents an array of
bytes.  Cinquecento strings have fixed length (possibly
zero), are indexed from position 0, and are not
null terminated.  Strings are mutable, but do not share
storage with other strings.  The maximum string length
is 2^64-1.
</p>

<p>
The C relational operators (<tt>==</tt>, <tt>!=</tt>,
<tt><</tt>, <tt>></tt>, <tt><=</tt>, <tt>>=</tt>) are
defined over strings.  They compare the contents of the
strings.  There is no way to test whether two string
instances are the same object.
</p>

<p>
The following functions comprise the basic string
operations.
</p>

<div class="docitem" id="fn:mkstr">
<div class="proto">
<div class="function">
<span class="id">mkstr(<span class="arg">len</span>)</span>
</div>
<div class="param">
<span class="arg">len</span>: <span class="type">cvalue</span>
</div>
<div class="returns">
<span class="type">string</span>
</div>
</div>
<div class="desc">
Returns a new string containing <span
class="arg">len</span> null bytes.
</div>
</div>

<div class="docitem" id="fn:strlen">
<div class="proto">
<div class="function">
<span class="id">strlen(<span class="arg">str</span>)</span>
</div>
<div class="param">
<span class="arg">str</span>: <span class="type">string</span>
</div>
<div class="returns">
<span class="type">cvalue</span>
</div>
</div>
<div class="desc">
Returns the number of bytes in <span class="arg">str</span>.
Equivalent to <tt>length(<span class="arg">str</span>)</tt>.
</div>
</div>

<div class="docitem" id="fn:substr">
<div class="proto">
<div class="function">
<span class="id">substr(<span class="arg">str</span>,<span class="arg">start</span>,<span class="arg">end</span>)</span>
</div>
<div class="param">
<span class="arg">str</span>: <span class="type">string</span>
</div>
<div class="param">
<span class="arg">start</span>: <span class="type">cvalue</span>
</div>
<div class="param">
<span class="arg">end</span>: <span class="type">cvalue</span>
</div>
<div class="returns">
<span class="type">string</span>
</div>
</div>
<div class="desc">
Returns a string containing a copy of the substring of <span
class="arg">from</span> starting at position
<span class="arg">start</span> up to but not including position 
<span class="arg">end</span>.
</div>
</div>

<div class="docitem" id="fn:strput">
<div class="proto">
<div class="function">
<span class="id">strput(<span class="arg">to</span>,<span class="arg">offset</span>,<span class="arg">from</span>)</span>
</div>
<div class="param">
<span class="arg">to</span>: <span class="type">string</span>
</div>
<div class="param">
<span class="arg">offset</span>: <span class="type">cvalue</span>
</div>
<div class="param">
<span class="arg">from</span>: <span class="type">string</span>
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
Copies the contents of string <span
class="arg">from</span> into <span of
class="arg">to</span>.  The copy begins at position
<span class="arg">offset</span> within <span
class="arg">to</span>.  It is an error if <span class="arg">to</span> is too short for <span
class="arg">from</span> to be copied in entirety.
</div>
</div>

<div class="docitem" id="fn:strton">
<div class="proto">
<div class="function">
<span class="id">strton(<span class="arg">str</span>)</span>
</div>
<div class="param">
<span class="arg">str</span>: <span class="type">string</span>
</div>
<div class="returns">
<span class="type">cvalue</span>
</div>
</div>
<div class="desc">
Converts the contents of <span class="arg">str</span>
to an integer cvalue in the literal domain.  The format
of <span class="arg">str</span> may be any valid C
integer constant.
</div>
</div>

<div class="docitem" id="fn:mapfile">
<div class="proto">
<div class="function">
<span class="id">mapfile(<span class="arg">filename</span>)</span>
</div>
<div class="param">
<span class="arg">filename</span>: <span class="type">string</span>
</div>
<div class="returns">
<span class="type">string</span>
</div>
</div>
<div class="desc">
Returns a string containing a copy of the contents of
the file named <span class="arg">filename</span>.
</div>
</div>

<p>
Several functions move strings to and
from address spaces.
</p>

<div class="docitem" id="fn:stringof">
<div class="proto">
<div class="function">
<span class="id">stringof(<span class="arg">ptr</span>)</span>
</div>
<div class="param">
<span class="arg">ptr</span>: <span class="type">cvalue</span> of type <span class="type">char*</span> or <span class="type">unsigned char*</span>
</div>
<div class="returns">
<span class="type">string</span>
</div>
</div>
<div class="desc">
Returns a string containing a copy of the bytes
beginning at <span class="arg">ptr</span> from the
address space associated with <span
class="arg">ptr</span>.  The string extends to, but
does not include, the first null byte at or beyond
<span class="arg">ptr</span>.  <span
class="id">Stringof</span> does not span address space
mapping boundaries: if the boundary of the address
space mapping containing <span class="arg">ptr</span>
is reached before a null byte is encountered, then the
search ends and the string of bytes seen so far is
returned.
</div>
</div>

<div class="docitem" id="fn:getbytes">
<div class="proto">
<div class="function">
<span class="id">getbytes(<span class="arg">ptr</span>[,<span class="arg">len</span>])</span>
</div>
<div class="param">
<span class="arg">ptr</span>: <span class="type">cvalue</span> of any pointer type
</div>
<div class="param">
<span class="arg">len</span>: <span class="type">cvalue</span>
</div>
<div class="returns">
<span class="type">string</span>
</div>
</div>
<div class="desc">
Returns a string containing a copy of the bytes
beginning at <span class="arg">ptr</span> from the
address space associated with <span
class="arg">ptr</span>.  If provided, <span
class="arg">len</span> is a non-negative count of bytes
to read; otherwise, <tt>sizeof(*<span
class="arg">ptr</span>)</tt> bytes are read.  It is an
error for the read to cross the boundary of the address
space mapping containing <span
class="arg">ptr</span>.
</div>
</div>

<div class="docitem" id="fn:putbytes">
<div class="proto">
<div class="function">
<span class="id">putbytes(<span class="arg">ptr</span>,<span class="arg">str</span>)</span>
</div>
<div class="param">
<span class="arg">ptr</span>: <span class="type">cvalue</span> of any pointer type
</div>
<div class="param">
<span class="arg">str</span>: <span class="type">string</span>
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
Copies the bytes in <span class="arg">str</span> into
address space associated with <span
class="arg">ptr</span>, starting at the location
pointed to by <span class="arg">ptr</span>.  It is an
error for the write to cross the boundary of the
address space mapping containing <span
class="arg">ptr</span>.
</div>
</div>

<h3>I/O</h3>

<p>
Cinquecento supports I/O over regular files and network
connections.  An open file or network connection is
represented by an instance of the file descriptor type.
</p>

<div class="docitem" id="fn:open">
<div class="proto">
<div class="function">
<span class="id">open(<span class="arg">filename</span>,<span class="arg">mode</span>)</span>
</div>
<div class="param">
<span class="arg">filename</span>: <span class="type">string</span>
</div>
<div class="param">
<span class="arg">mode</span>: <span class="type">string</span>
</div>
<div class="returns">
<span class="type">file descriptor</span>
</div>
</div>
<div class="desc">
Opens the file named <span class="arg">filename</span> and
returns the associated file descriptor.  <span
class="arg">Mode</span> specifies whether the file is to
be opened for reading, writing, or both, and whether
the file is to be created or truncated.  The syntax of
<span class="arg">mode</span> follows that of the C
library stdio <tt>fopen</tt> function.  Common modes
are <span class="val">"r"</span> (read an existing file)
<span class="val">"w"</span> (truncate an existing file
for writing), and <span class="val">"rw"</span> (truncate
an existing file for reading and writing).
</div>
</div>

<div class="docitem" id="fn:opentcp">
<div class="proto">
<div class="function">
<span class="id">opentcp(<span class="arg">address</span>)</span>
</div>
<div class="param">
<span class="arg">address</span>: <span class="type">string</span>
</div>
<div class="returns">
<span class="type">file descriptor</span>
</div>
</div>
<div class="desc">
Opens a TCP connection to <span class="arg">address</span> and
returns the associated file descriptor.
<span class="arg">Address</span> is a string of the form
<tt>"<em>addr</em>:<em>port</em>"</tt>, where
<span class="arg">addr</span> is an IP address or hostname and
<span class="arg">port</span> is a port number or service
name.
</div>
</div>

<div class="docitem" id="fn:read">
<div class="proto">
<div class="function">
<span class="id">read(<span class="arg">fd</span>,<span class="arg">len</span>)</span>
</div>
<div class="param">
<span class="arg">fd</span>: <span class="type">file descriptor</span>
</div>
<div class="param">
<span class="arg">len</span>: <span class="type">cvalue</span>
</div>
<div class="returns">
<span class="type">string</span> or <span class="type">nil</span>
</div>
</div>
<div class="desc">
Reads at most <span class="arg">len</span> bytes from the I/O
resource associated with <span class="arg">fd</span>.  The
call blocks until <span class="arg">len</span> bytes are
read or end of file is encountered.  Returns a string
containing the bytes read, or <tt>nil</tt> if end of
file was encountered and no bytes were read.
</div>
</div>

<div class="docitem" id="fn:write">
<div class="proto">
<div class="function">
<span class="id">write(<span class="arg">fd</span>,<span class="arg">str</span>)</span>
</div>
<div class="param">
<span class="arg">fd</span>: <span class="type">file descriptor</span>
</div>
<div class="param">
<span class="arg">str</span>: <span class="type">string</span>
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
Writes the bytes contained in the string
<span class="arg">str</span> to the I/O resource associated
with <span class="arg">fd</span>.
</div>
</div>

<div class="docitem" id="fn:close">
<div class="proto">
<div class="function">
<span class="id">close(<span class="arg">fd</span>)</span>
</div>
<div class="param">
<span class="arg">fd</span>: <span class="type">file descriptor</span>
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
Closes the I/O resource associated with <span
class="arg">fd</span>.  Any pending buffered output is
written.  A call to <span class="id">close</span> on an
already closed descriptor has no effect.  A call to
<span class="id">read</span> or <span
class="id">write</span> on a closed descriptor draws an
error.
</div>
</div>

<div class="docitem" id="fn:fdname">
<div class="proto">
<div class="function">
<span class="id">fdname(<span class="arg">fd</span>)</span>
</div>
<div class="param">
<span class="arg">fd</span>: <span class="type">file descriptor</span>
</div>
<div class="returns">
<span class="type">string</span>
</div>
</div>
<div class="desc">
Returns the name of the I/O resource associated with <span
class="arg">fd</span>.
</div>
</div>

<h3 id="sec:system">Filesystem Operations</h3>

<p>
This section documents functions that operate on the file system.
</p>

<div class="docitem" id="fn:mkdir">
<div class="proto">
<div class="function">
<span class="id">mkdir(<span class="arg">name</span>)</span>
</div>
<div class="param">
<span class="arg">name</span>: <span class="type">string</span>
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
Creates a new directory named <span class="arg">name</span>.
</div>
</div>

<div class="docitem" id="fn:rmdir">
<div class="proto">
<div class="function">
<span class="id">rmdir(<span class="arg">name</span>)</span>
</div>
<div class="param">
<span class="arg">name</span>: <span class="type">string</span>
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
Removes the directory named <span class="arg">name</span>.
</div>
</div>

<div class="docitem" id="fn:unlink">
<div class="proto">
<div class="function">
<span class="id">unlink(<span class="arg">name</span>)</span>
</div>
<div class="param">
<span class="arg">name</span>: <span class="type">string</span>
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
Removes the file named <span class="arg">name</span>.
</div>
</div>


<h3 id="sec:system">Formatted Output</h3>

<p>
Cinquecento provides several functions for C-style
formatted output to various destinations.
</p>

<p>
Each function expects a format string argument.
The format string
can contain conversion specifications similar (but not identical)
to those handled by C stdio library functions.
Each conversion specification has the form <span
class="val">%<span class="arg">verb</span></span>.  The
specifications are processed in order; each operates
in turn on the remaining values passed to the format
function.
</p>

<p>
Each <span class="arg">verb</span> is a
single character.  The recognized verbs are:
</p>

<div id="table">
<table>

<tr>
<td><span class="val">a</span></td>
<td>
Formats any type of value in an implementation-defined
format.
</td>
</tr>

<tr>
<td><span class="val">c</span></td>
<td>
Formats a character value as an ascii character (if printable)
or in octal.
</td>
</tr>

<tr>
<td><span class="val">d,o,x,X,u</span></td>
<td>
Formats an integer or pointer value in signed decimal,
octal, lowercase hex, uppercase hex, or unsigned
decimal.
</td>
</tr>

<tr>
<td><span class="val">p</span></td>
<td>
Formats a pointer value in lowercase hex.
</td>
</tr>

<tr>
<td><span class="val">s</span></td>
<td>
Copies a string value.  If the value is not already a string, it is first passed to  <span class="id"><a
href="#fn:stringof">stringof</a></span>, which expects
a cvalue of type <span
class="type">char*</span> or <span
class="type">unsigned char*</span>.
</td>
</tr>

<tr>
<td>
<span class="val">t</span>
</td>
<td>
Formats a ctype.  The value may be in one of two forms:
(1) a ctype, in which case it is formatted as a
conventional C type specification, or (2) a vector,
representing a C symbol, of the form <span
class="val">[ <span class="arg">T</span>, <span
class="arg">ID</span>, ... ]</span>, where <span
class="arg">T</span> is a ctype and <span
class="arg">ID</span> is a string or <span
class="val">nil</span>, in which case the symbol is
formatted as conventional (possibly abstract) C
declaration.
</td>
</tr>

<tr>
<td>
<span class="val">y</span>
</td>
<td>
Formats an integer or pointer value as <span
class="val">"<span class="arg">symbol</span>+<span
class="arg">offset</span>"</span>.
<span class="arg">Symbol</span> is the symbol returned
by a call to the name space <span class="arg"><a
href="#fn:lookaddr">lookaddr</a></span> operation on
the value.  <span class="arg">Offset</span> is the
difference between the value and the location of the symbol returned by
<span class="arg">lookaddr</span>.  If the difference
is zero, the offset is suppressed.
</td>
</tr>
</table>
</div>

<p>
The formatted output functions are:
</p>

<div class="docitem" id="fn:printf">
<div class="proto">
<div class="function">
<span class="id">printf(<span class="arg">fmt</span>, ...)</span>
</div>
<div class="param">
<span class="arg">fmt</span>: <span class="type">format string</span>
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
Sends formatted output to the current standard output.
</div>
</div>

<div class="docitem" id="fn:fprintf">
<div class="proto">
<div class="function">
<span class="id">fprintf(<span class="arg">fd</span>, <span class="arg">fmt</span>, ...)</span>
</div>
<div class="param">
<span class="arg">fd</span>: <span class="type">file descriptor</span>
</div>
<div class="param">
<span class="arg">fmt</span>: <span class="type">format string</span>
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
Sends formatted output to I/O resource associated with <span class="arg">fd</span>.
</div>
</div>

<div class="docitem" id="fn:sprintfa">
<div class="proto">
<div class="function">
<span class="id">sprintfa(<span class="arg">fmt</span>, ...)</span>
</div>
<div class="param">
<span class="arg">fmt</span>: <span class="type">format string</span>
</div>
<div class="returns">
<span class="type">string</span>
</div>
</div>
<div class="desc">
Returns a new string containing formatted output.
</div>
</div>



<h3 id="sec:system">System Functions</h3>

<p>
This section documents various system-level functions.
</p>

<div class="docitem" id="fn:getpid">
<div class="proto">
<div class="function">
<span class="id">getpid()</span>
</div>
<div class="returns">
<span class="type">cvalue</span>
</div>
</div>
<div class="desc">
Returns the process identifier of the process in which
the Cinquecento system is running.
</div>
</div>

<div class="docitem" id="fn:gettimeofday">
<div class="proto">
<div class="function">
<span class="id">gettimeofday()</span>
</div>
<div class="returns">
<span class="type">cvalue</span>
</div>
</div>
<div class="desc">
Returns the current time in microseconds.
</div>
</div>

<div class="docitem" id="fn:backtrace">
<div class="proto">
<div class="function">
<span class="id">backtrace()</span>
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
Prints to the current standard output a formatted
snapshot of the Cinquecento call stack.
</div>
</div>

<div class="docitem" id="fn:rand">
<div class="proto">
<div class="function">
<span class="id">rand(<span class="arg">max</span>)</span>
</div>
<div class="param">
<span class="arg">max</span>: <span class="type">cvalue</span>
</div>
<div class="returns">
<span class="type">cvalue</span>
</div>
</div>
<div class="desc">
Returns a random integer in the range [0...<span
class="arg">max</span>).  It is an error if <span
class="arg">max</span> exceeds the
implementation-defined maximum random number.
</div>
</div>

<div class="docitem" id="fn:randseed">
<div class="proto">
<div class="function">
<span class="id">randseed(<span class="arg">seed</span>)</span>
</div>
<div class="param">
<span class="arg">seed</span>: <span class="type">cvalue</span>
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
Seeds the random number generator used by <span class="id">rand</span>.
</div>
</div>

<h3 id="sec:fnindex">Function Index</h3>
<div class="id">
<div class="fnindex">
<a href="#fn:append">append</a><br>
<a href="#fn:backtrace">backtrace</a><br>
<a href="#fn:close">close</a><br>
<a href="#fn:copy">copy</a><br>
<a href="#fn:fdname">fdname</a><br>
<a href="#fn:foreach">foreach</a><br>
<a href="#fn:fprintf">fprintf</a><br>
<a href="#fn:getbytes">getbytes</a><br>
<a href="#fn:getpid">getpid</a><br>
<a href="#fn:gettimeofday">gettimeofday</a><br>
<a href="#fn:head">head</a><br>
<a href="#fn:isempty">isempty</a><br>
<a href="#fn:length">length</a><br>
<a href="#fn:list">list</a><br>
<a href="#fn:listdel">listdel</a><br>
<a href="#fn:listins">listins</a><br>
<a href="#fn:listref">listref</a><br>
<a href="#fn:listset">listset</a><br>
<a href="#fn:mapfile">mapfile</a><br>
<a href="#fn:mkdir">mkdir</a><br>
<a href="#fn:mkstr">mkstr</a><br>
<a href="#fn:mktab">mktab</a><br>
<a href="#fn:mkvec">mkvec</a><br>
<a href="#fn:open">open</a><br>
<a href="#fn:opentcp">opentcp</a><br>
<a href="#fn:pop">pop</a><br>
<a href="#fn:printf">printf</a><br>
<a href="#fn:push">push</a><br>
<a href="#fn:putbytes">putbytes</a><br>
<a href="#fn:rand">rand</a><br>
<a href="#fn:rand">randseed</a><br>
<a href="#fn:read">read</a><br>
<a href="#fn:reverse">reverse</a><br>
<a href="#fn:sprintfa">sprintfa</a><br>
<a href="#fn:stringof">stringof</a><br>
<a href="#fn:strlen">strlen</a><br>
<a href="#fn:strput">strput</a><br>
<a href="#fn:strton">strton</a><br>
<a href="#fn:substr">substr</a><br>
<a href="#fn:tabdelete">tabdelete</a><br>
<a href="#fn:tabenum">tabenum</a><br>
<a href="#fn:tabinsert">tabinsert</a><br>
<a href="#fn:tabkeys">tabkeys</a><br>
<a href="#fn:tablook">tablook</a><br>
<a href="#fn:tabvals">tabvals</a><br>
<a href="#fn:tail">tail</a><br>
<a href="#fn:unlink">unlink</a><br>
<a href="#fn:veclen">veclen</a><br>
<a href="#fn:vecref">vecref</a><br>
<a href="#fn:vecset">vecset</a><br>
<a href="#fn:vector">vector</a><br>
<a href="#fn:write">write</a><br>
</div>
</div>

</div>
</body>
</html>
