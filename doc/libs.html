<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<title>Cinquecento Libraries</title>
<link rel="stylesheet" type="text/css" href="reset.css"/>
<link rel="stylesheet" type="text/css" href="styles.css"/>
</head>

<body>

<div id="side1">
<a href="#sec:introduction">Introduction</a><br />
<br />
<em>Standard Libraries</em><br />
<a href="#lib:asutil">asutil</a><br />
<a href="#lib:core.cqct">core</a><br />
<a href="#lib:dump.cqct">dump</a><br />
<a href="#lib:dynamictypes.cqct">dynamictypes</a><br />
<a href="#lib:elf.cqct">elf</a><br />
<a href="#lib:nsgraph.cqct">nsgraph</a><br />
<a href="#lib:nsoff.cqct">nsoff</a><br />
<a href="#lib:nsutil.cqct">nsutil</a><br />
<a href="#lib:snames.cqct">snames</a><br />
<a href="#lib:snamesclt.cqct">snamesclt</a><br />
</div>

<div id="content">

<div id="title">
<h3>Cinquecento Libraries</h3>
</div>

<h4 id="sec:introduction">Introduction</h4>

<p>
This document describes various libraries provided with
the L1 implementation of Cinquecento. It is not
complete.  See <a href=man.html>the L1 Manual</a> for
more details on Cinquecento and L1.
</p>

<h4 id="sec:stdlib">Standard Libraries</h4>

<p>
The L1 implementation of Cinquecento comes with several 
standard libraries stored
in the lib/ subdirectory. Since they are included in
l1's load path, these libraries are loaded via the form:
</p>
<div class="code">
@include &lt;<span class="arg">library</span>&gt;<br />
</div>

<p>
This section gives non-exhaustive describions 
for several of the provided libraries.
</p>

<h5 id="lib:asutil.cqct">asutil.cqct</h5>

<span class="id">asutil.cqct</span> provides code for 
loading, saving, and copying address spaces. 

<div class="docitem" id="fn:asload">
<div class="proto">
<div class="function">
<span class="id">asload(<span class="arg">filename</span>)</span>
</div>
<div class="param">
<span class="arg">filename</span>: <span class="type">string</span> 
</div>
<div class="returns">
<span class="type">address space</span>
</div>
</div>
<div class="desc">
Loads the address space saved to the file 
in <span class="arg">filename</span>.
</div>
</div>

<div class="docitem" id="fn:asload_str">
<div class="proto">
<div class="function">
<span class="id">asload_str(<span class="arg">str</span>)</span>
</div>
<div class="param">
<span class="arg">str</span>: <span class="type">string</span> 
</div>
<div class="returns">
<span class="type">address space</span>
</div>
</div>
<div class="desc">
Loads the address space saved in the string
<span class="arg">str</span>.
</div>
</div>

<div class="docitem" id="fn:assave">
<div class="proto">
<div class="function">
<span class="id">assave(<span class="arg">as</span>,
			<span class="arg">filename</span>)</span>
</div>
<div class="param">
<span class="arg">as</span>: <span class="type">address space</span> 
<span class="arg">filename</span>: <span class="type">string</span> 
</div>
<div class="returns">
<span class="type">undefined</span>
</div>
</div>
<div class="desc">
Saves the address space 
<span class="arg">as</span>
to the file <span class="arg">filename</span>.
</div>
</div>

<div class="docitem" id="fn:assave_str">
<div class="proto">
<div class="function">
<span class="id">assave_str(<span class="arg">as</span>)</span>
</div>
<div class="param">
<span class="arg">as</span>: <span class="type">address space</span> 
</div>
<div class="returns">
<span class="type">string</span>
</div>
</div>
<div class="desc">
Saves the address space 
<span class="arg">as</span> to a string, and returns that string.
</div>
</div>

<div class="docitem" id="fn:ascopy">
<div class="proto">
<div class="function">
<span class="id">ascopy(<span class="arg">as</span>)</span>
</div>
<div class="param">
<span class="arg">as</span>: <span class="type">address space</span> 
</div>
<div class="returns">
<span class="type">address space</span>
</div>
</div>
<div class="desc">
Creates a copy of the address space <span class="arg">as</span>, 
and returns the copy. No changes to the returned address space
affect the passed address space.
</div>
</div>

<h5 id="lib:core.cqct">core.cqct</h5>

<span class="id">core.cqct</span> provides functionality for loading
a core file as an address space.

<div class="docitem" id="fn:mkcoreas">
<div class="proto">
<div class="function">
<span class="id">mkcoreas(<span class="arg">fname</span>)</span>
</div>
<div class="param">
<span class="arg">fname</span>: <span class="type">string</span> 
</div>
<div class="returns">
<span class="type">address space</span>
</div>
</div>
<div class="desc">
	Returns an domain for the provided core file representing that program
	at the point at which the core file was created. The domain defines
	the functions getXXX, where XXX can be any of the standard register
	names. 
</div>
</div>

<h5 id="lib:dump.cqct">dump.cqct</h5>

<span class="id">dump.cqct</span> provides code for printing
out namespaces and the values associated with typed pointers.

<div class="docitem" id="fn:printtype">
<div class="proto">
<div class="function">
<span class="id">printtype(<span class="arg">t</span>)</span>
</div>
<div class="param">
<span class="arg">t</span>: <span class="type">ctype</span> 
</div>
<div class="returns">
<span class="type">string</span>
</div>
</div>
<div class="desc">
Returns a string representation
of the provided ctype that can be included inside a @names directive. 
</div>
</div>

<div class="docitem" id="fn:dumpns">
<div class="proto">
<div class="function">
<span class="id">dumpns(<span class="arg">dn</span>)</span>
</div>
<div class="param">
<span class="arg">dn</span>: 
Domain or name space to be printed.
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
Prints all types in the given domain or name space to standard out.
</div>
</div>

<div class="docitem" id="fn:objectStr">
<div class="proto">
<div class="function">
<span class="id">objectStr(<span class="arg">x</span>)</span>
</div>
<div class="param">
<span class="arg">x</span>: 
Pointer to a cvalue. 
</div>
<div class="returns">
<span class="type">string</span>
</div>
</div>
<div class="desc">
Pretty-prints the object pointed to by x based on x's ctype to
a string, and returns that string.
</div>
</div>

<h5 id="lib:dynamictypes.cqct">dynamictypes.cqct</h5>

This file provides the ability to create dynamic types, or types
that change based on their content. For example, consider the following
vector type:
<div class="code">
<pre>
struct Vector {
        unsigned int size;
        int data[];
};
</pre>
</div>
The data pointer is actually an array of length size.
With dynamic typing, one can specify types such that a pointer
<span class="id">p</span> pointing to an object of type 
<span class="id">Vector</span> can be translated into the appropriate
type using the <span class="id">refine</span> function. In this case,
that type will be:
<div class="code">
<pre>
stuct Vector {
        unsigned int size;
	int data[p->size];
};
</pre>
</div>

The basic idea is for the person defining the type to include an 
extra mapping in fields for the
keyword "refine", which specifies a function for performing the
transformation. Then for a pointer to an object p, one can call
refine(p) to create a pointer that points to the refined version
of the type of p.

For a complete example, see the <span class="function">example</span>
function in the file <span class="id">dynamictypes.cqct</span>.

<div class="docitem" id="fn:refine">
<div class="proto">
<div class="function">
<span class="id">refine(<span class="arg">p</span>)</span>
</div>
<div class="param">
<span class="arg">p</span>: 
A cvalue pointer. 
</div>
<div class="returns">
<span class="type">A cvalue pointer.</span>
</div>
</div>
<div class="desc">
Returns a pointer to the same address as is pointed to by 
<span class="arg">p</span>, but points to a refined version of
<span class="arg">p</span>'s type. The newly refined type inherits
any refinement properties from the old type so that further calls
to refine will behave as expected. If 
any part of the object <span class="arg">p</span> points to is
unmapped, or if any part of the refined structure <span class="arg">p</span>
would have pointed to on return is unmapped, then no changes are made.
</div>
</div>

<h5 id="lib:elf.cqct">elf.cqct</h5>

<span class="id">elf.cqct</span> contains code for handling elf files.
Much of this function provides machinery to keep the client code unaware
of whether or not the elf file underconsideration contains a 32 or 64 bit
address space. The recode bd
type, which is instantiated through <a href=#fn:mkelfrec>mkelfrec</a>,
is where the elf domain is contained. The elfsym types, which are 
created via <a href=#fn:getcqctelfsym>getcqctelfsym</a> contain information
about specific elf symbols. 

<div class="docitem" id="record:bd">
Record <span class="id">bd</span> created by 
	<a href=#fn:mkelfrec>mkelfrec</a>
<div class="field">
<span class="id">rootns</span>: namespace for the elf file</span>
</div>
<div class="field">
<span class="id">elf</span>: domain for the elf file</span>
</div>
</div>

<div class="docitem" id="type:elfsym">
Vector <span class="id">elfsym</span> is used to store information on elf 
symbols. These are created by <a href=#fn:getcqctelfsym>getcqctelfsym</a>,
and can be printed with <a href=#fn:showsym>showsym</a>.
That information can be harvested directly by the following functions:
<div class="field">
<span class="id">elfname(esym)</span>: returns the name (field 0)</span>
</div>
<div class="field">
<span class="id">elfaddr(esym)</span>: returns the address (field 1)</span>
</div>
<div class="field">
<span class="id">elftype(esym)</span>: returns the type (field 2)</span>
</div>
<div class="field">
<span class="id">elfvisibility(esym)</span>: returns the visibility (field 3)</span>
</div>
<div class="field">
<span class="id">elfsize(esym)</span>: returns the size (field 4)</span>
</div>
<div class="field">
<span class="id">elfinfo(esym)</span>: returns the info (field 5)</span>
</div>
<div class="field">
<span class="id">elfother(esym)</span>: returns the other stuff (field 6)</span>
</div>
<div class="field">
<span class="id">elfshndx(esym)</span>: returns the type (field 7)</span>
</div>
</div>

<div class="docitem" id="fn:dumpsym">
<div class="proto">
<div class="function">
<span class="id">dumpsym(<span class="arg">name</span>,
	<span class="arg">esym</span>)</span>
</div>
<div class="param">
<span class="arg">name</span>: <span class="type">string</span> 
</div>
<div class="param">
<span class="arg">esym</span>: <span class="type">struct ElfXX_Sym*</span> 
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
	For an ElfXX_Sym* object with name name, print its contents.
</div>
</div>

<div class="docitem" id="fn:getcqctelfsym">
<div class="proto">
<div class="function">
	<span class="id">getcqctelfsym(
		<span class="arg">edom</span>,
		<span class="arg">esym</span>,
		<span class="arg">name</span>)</span>
</div>
<div class="param">
<span class="arg">edom</span>: <span class="type">domain</span> 
</div>
<div class="param">
<span class="arg">esym</span>: <span class="type">ElfXX_Sym*</span> 
</div>
<div class="returns">
<span class="type">vector</span>
</div>
</div>
<div class="desc">
	Convert a raw ELF symbol from the binary into a Cinquecento list of
	the processed field values of type <a href=#type:elfsym>elfsym</a>.
</div>
</div>

<div class="docitem" id="fn:getelfsecname">
<div class="proto">
<div class="function">
	<span class="id">getelfsecname(
		<span class="arg">edom</span>,
		<span class="arg">ind</span>)</span>
</div>
<div class="param">
<span class="arg">edom</span>: <span class="type">domain</span> 
</div>
<div class="param">
<span class="arg">ind</span>: <span class="type">string</span> 
</div>
<div class="returns">
<span class="type">string</span>
</div>
</div>
<div class="desc">
	Get the name of an elf section. This function does not check that there
	actually is a section at that index.
</div>
</div>

<div class="docitem" id="fn:getelfsection">
<div class="proto">
<div class="function">
	<span class="id">getelfsection(
		<span class="arg">edom</span>,
		<span class="arg">name</span>)</span>
</div>
<div class="param">
<span class="arg">edom</span>: <span class="type">domain</span> 
</div>
<div class="param">
<span class="arg">name</span>: <span class="type">string</span> 
</div>
<div class="returns">
<span class="type">string</span>
</div>
</div>
<div class="desc">
	Get a byte string containing the data of the named ELF section
	from the provided elf domain (returns "" if no section with that
	name exists).
</div>
</div>

<div class="docitem" id="fn:getelfsegment">
<div class="proto">
<div class="function">
	<span class="id">getelfsegment(
		<span class="arg">edom</span>,
		<span class="arg">n</span>)</span>
</div>
<div class="param">
<span class="arg">edom</span>: <span class="type">domain</span> 
</div>
<div class="param">
<span class="arg">n</span>: <span class="type">string</span> 
</div>
<div class="returns">
<span class="type">ElfXX_Phdr*</span>
</div>
</div>
<div class="desc">
	Return a byte string containing the data of ELF section number n.
</div>
</div>

<div class="docitem" id="fn:getelfsegmenthdr">
<div class="proto">
<div class="function">
	<span class="id">getelfsegmenthdr(
		<span class="arg">edom</span>,
		<span class="arg">n</span>)</span>
</div>
<div class="param">
<span class="arg">edom</span>: <span class="type">domain</span> 
</div>
<div class="param">
<span class="arg">n</span>: <span class="type">string</span> 
</div>
<div class="returns">
<span class="type">ElfXX_Phdr*</span>
</div>
</div>
<div class="desc">
	Gets header number n from the provided elf domain.
	Returns null if there is no header n.
</div>
</div>

<div class="docitem" id="fn:getelfsyms">
<div class="proto">
<div class="function">
<span class="id">getelfsyms(<span class="arg">edom</span>)</span>
</div>
<div class="param">
<span class="arg">edom</span>: <span class="type">domain</span> 
</div>
<div class="returns">
<span class="type">vector</span>
</div>
</div>
<div class="desc">
	Returns a vector of cqct symbols in the given elf domain
</div>
</div>

<div class="docitem" id="fn:getsyms">
<div class="proto">
<div class="function">
<span class="id">getsyms(<span class="arg">elfdom</span>)</span>
</div>
<div class="param">
<span class="arg">elfdom</span>: <span class="type">domain</span> 
</div>
<div class="returns">
<span class="type">table</span>
</div>
</div>
<div class="desc">
	prints the symbols in a given elf domain, returning a table
	mapping strings to pointers to ElfXX_Sym objects.
</div>
</div>

<div class="docitem" id="fn:mkelfrec">
<div class="proto">
<div class="function">
<span class="id">mkelfrec(<span class="arg">binfile</span>)</span>
</div>
<div class="param">
<span class="arg">binfile</span>: <span class="type">binary string</span> 
</div>
<div class="returns">
<span class="type">bd record</span>
</div>
</div>
<div class="desc">
	Returns a bd record describing an elf file.
</div>
</div>

<div class="docitem" id="fn:showallelfsectionheaders">
<div class="proto">
<div class="function">
<span class="id">showallelfsectionheaders(<span class="arg">elfdom</span>)</span>
</div>
<div class="param">
<span class="arg">elfdom</span>: <span class="type">domain</span> 
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
	Prints all sections headers from the given elf domain.
</div>
</div>

<div class="docitem" id="fn:showelfheader">
<div class="proto">
<div class="function">
<span class="id">showelfheader(<span class="arg">elfdom</span>)</span>
</div>
<div class="param">
<span class="arg">elfdom</span>: <span class="type">domain</span> 
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
	Prints the root header from the elf domain.
</div>
</div>

<div class="docitem" id="fn:showelfsym">
<div class="proto">
<div class="function">
	<span class="id">showelfsym(
		<span class="arg">elfdom</span>,
		<span class="arg">addr</span>,
		<span class="arg">strind</span>
		)</span>
</div>
<div class="param">
<span class="arg">elfdom</span>: <span class="type">domain</span> 
</div>
<div class="param">
	<span class="arg">addr</span>: <span class="type">void*</span> 
</div>
<div class="param">
	<span class="arg">strind</span>: <span class="type">int</span> 
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
	Prints a description of the elf symbol at the given addr with
	the given offset into the e_shoff table.
</div>
</div>

<div class="docitem" id="fn:showsectionheader">
<div class="proto">
<div class="function">
	<span class="id">showsectionheader(
		<span class="arg">elfdom</span>,
		<span class="arg">sbase</span>,
		<span class="arg">index</span>
		)</span>
</div>
<div class="param">
<span class="arg">elfdom</span>: <span class="type">domain</span> 
</div>
<div class="param">
	<span class="arg">sbase</span>: 
	<span class="type">elfdom`Elf64_Shdr*</span>  or
	<span class="type">elfdom`Elf32_Shdr*</span> 
</div>
<div class="param">
<span class="arg">index</span>: <span class="type">int</span> 
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
	Prints a section header at index for the given elf domain.
</div>
</div>

<div class="docitem" id="fn:showsegmentheader">
<div class="proto">
<div class="function">
	<span class="id">showsegmentheader(
		<span class="arg">eseg</span>)</span>
</div>
<div class="param">
<span class="arg">elfdom</span>: <span class="type">domain</span> 
</div>
<div class="param">
	<span class="arg">eseg</span>: 
	<span class="type">elfdom`Elf64_Phdr*</span>  or
	<span class="type">elfdom`Elf32_Phdr*</span> 
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
	Print informaiton in an ElfXX_Phdr* object.
</div>
</div>

<div class="docitem" id="fn:showsym">
<div class="proto">
<div class="function">
<span class="id">showsym(<span class="arg">esym</span>)</span>
</div>
<div class="param">
<span class="arg">esym</span>: <span class="type">elfsym</span> 
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
	Print information in the given 
	<a href=#type:elfsym>elfsym</a>.
</div>
</div>




<div class="docitem" id="fn:show_elf_addrs">
<div class="proto">
<div class="function">
<span class="id">show_elf_addrs(<span class="arg">syms</span>)</span>
</div>
<div class="param">
<span class="arg">syms</span>: <span class="type">vector</span> 
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
	Prints the address (in hex) for every vector in the list.
</div>
</div>

<div class="docitem" id="fn:show_elf_syms">
<div class="proto">
<div class="function">
<span class="id">show_elf_syms(<span class="arg">syms</span>)</span>
</div>
<div class="param">
<span class="arg">syms</span>: <span class="type">vector</span> 
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
	Runs showsym over every entry in the given array.
</div>
</div>

<h5 id="lib:nsgraph.cqct">nsgraph.cqct</h5>

<span class="id">nsgraph.cqct</span> provides code for 
creating and analyzing graphs of types inferred from a namespace.

<div class="docitem" id="fn:gentypegraph">
<div class="proto">
<div class="function">
	<span class="id">gentypegraph(<span class="arg">ns</span>)
	</span>
</div>
<div class="param">
<span class="arg">ns</span>: <span class="type">namespace</span> 
</div>
<div class="returns">
<span class="type">table</span>
</div>
</div>
<div class="desc">
	Returns a table representation of the graph implied by the 
	structures and unions in the given namespace.
</div>
</div>

<div class="docitem" id="fn:printtypegraph">
<div class="proto">
<div class="function">
	<span class="id">printtypegraph(<span class="arg">ns</span>)
	</span>
</div>
<div class="param">
<span class="arg">ns</span>: <span class="type">namespace</span> 
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
	Prints the typegraph associated with the given namespace.
</div>
</div>

<div class="docitem" id="fn:printtypegraph_dot">
<div class="proto">
<div class="function">
	<span class="id">printtypegraph_dot(<span class="arg">ns</span>)
	</span>
</div>
<div class="param">
<span class="arg">ns</span>: <span class="type">namespace</span> 
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
	Prints a dot compatible representation of the typegraph 
	associated with the given namespace.
</div>
</div>

<div class="docitem" id="fn:typegraph_edge_iter">
	<div class="proto">
		<div class="function">
			<span class="id">typegraph_edge_iter(<span class="arg">tg</span>,
				<span class="arg">fn</span>)
			</span>
		</div>
		<div class="param">
			<span class="arg">tg</span>: <span class="type">table representation of
				the typegraph</span> 
		</div>
		<div class="param">

			<span class="arg">fn</span>: <span class="type">function</span>
		</div>
		<div class="returns">
			<span class="type">nil</span>
		</div>
	</div>
	<div class="desc">
		Runs fn(from_node,to_node) for all edges in the typegraph.
	</div>
</div>

<div class="docitem" id="fn:typegraph_node_iter">
	<div class="proto">
		<div class="function">
			<span class="id">typegraph_node_iter(<span class="arg">tg</span>,
				<span class="arg">fn</span>)
			</span>
		</div>
		<div class="param">
			<span class="arg">tg</span>: <span class="type">table representation of
				the typegraph</span> 
		</div>
		<div class="param">
			<span class="arg">fn</span>: <span class="type">function</span>
		</div>
		<div class="returns">
			<span class="type">nil</span>
		</div>
	</div>
	<div class="desc">
		Runs fn(from_node,to_nodes) for all nodes in the typegraph.
		Note that the second parameter to fn will be a list.
	</div>
</div>

<h5 id="lib:nsoff.cqct">nsoff.cqct</h5>

<span class="id">nsoff.cqct</span> provides a function 
creating a namespace whose symbols are translated some offset
from some other provided namespace.

<div class="docitem" id="fn:mknsoff">
<div class="proto">
<div class="function">
	<span class="id">mksnoff(<span class="arg">ns</span>,
				 <span class="arg">off</span>)
	</span>
</div>
<div class="param">
<span class="arg">ns</span>: <span class="type">namespace</span> 
</div>
<div class="param">
<span class="arg">off</span>: <span class="type">unsigned integer</span> 
</div>
<div class="returns">
<span class="type">name space</span>
</div>
</div>
<div class="desc">
	Returns a namespace whose symbols are are translated off from
	their original location. For example, the symbol at offset 0x10 in 
	ns1 will be at offset 0x20 in mknsoff(ns1,0x10). 
	This namespace is implemented in such a way as to not interfere with
	the caching provided by the sctl namespaces. 
</div>
</div>

<h5 id="lib:nsutil.cqct">nsutil.cqct</h5>

<span class="id">nsutil.cqct</span> provides code for 
checking type equality, printing namespaces, and iterating
over types in namespaces.

<div class="docitem" id="fn:all_types">
<div class="proto">
<div class="function">
	<span class="id">all_types(<span class="arg">ns</span>)
	</span>
</div>
<div class="param">
<span class="arg">ns</span>: <span class="type">namespace</span> 
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
	Print all the types in a namespace (not parsable by cqct).
</div>
</div>

<div class="docitem" id="fn:nsdiff">
<div class="proto">
<div class="function">
	<span class="id">nsdiff(<span class="arg">t1</span>,
		<span class="arg">t2</span>)
	</span>
</div>
<div class="param">
<span class="arg">n1</span>: <span class="type">type</span> 
</div>
<div class="param">
<span class="arg">n2</span>: <span class="type">type</span> 
</div>
<div class="returns">
<span class="type">array</span>
</div>
</div>
<div class="desc">
	Prints the types in each namespace that are not contained
	in the other namespace or have a different definition in 
	the other namespace. Returns [tab1, tab2, tab3] where tab1 
	contains types in ns1 that are not
	in ns2, and tab2 contains types in ns2 that are not in ns1, and tab3
	maps types in either ns to a type with the same name in the other ns
	that is not the same type.
</div>
</div>

<div class="docitem" id="fn:nsiter">
<div class="proto">
<div class="function">
	<span class="id">nsiter(<span class="arg">ns</span>,
		<span class="arg">fn</span>)
	</span>
</div>
<div class="param">
<span class="arg">ns</span>: <span class="type">namespace</span> 
</div>
<div class="param">
<span class="arg">fn</span>: <span class="type">function</span> 
</div>
<div class="returns">
<span class="type">array</span>
</div>
</div>
<div class="desc">
	Runs fn(type) for every type in the namespace.
</div>
</div>

<div class="docitem" id="fn:nsjoin">
<div class="proto">
<div class="function">
	<span class="id">nsjoin(<span class="arg">ns1</span>,
		<span class="arg">ns2</span>)
	</span>
</div>
<div class="param">
<span class="arg">ns1</span>: <span class="type">namespace</span> 
</div>
<div class="param">
<span class="arg">ns2</span>: <span class="type">namespace</span> 
</div>
<div class="returns">
<span class="type">namespace</span>
</div>
</div>
<div class="desc">
	retuns a namespace that contains all types and symbols in
	both namespaces ns1 and ns2. When both namespaces define
	a symbol or a type, the definition in ns2 is preferred.
</div>
</div>

<div class="docitem" id="fn:printns">
<div class="proto">
<div class="function">
	<span class="id">printns(<span class="arg">ns</span>)
	</span>
</div>
<div class="param">
<span class="arg">ns</span>: <span class="type">namespace</span> 
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
	Prints the namespace in a format parsable by cqct in an @names
	directive.
</div>
</div>

<div class="docitem" id="fn:printtype">
<div class="proto">
<div class="function">
	<span class="id">printtype(<span class="arg">t1</span>)
	</span>
</div>
<div class="param">
<span class="arg">t1</span>: <span class="type">type</span> 
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
	Prints the type in a format parsable by cqct.
</div>
</div>

<div class="docitem" id="fn:typeequal">
<div class="proto">
<div class="function">
	<span class="id">typeequal(<span class="arg">t1</span>,
		<span class="arg">t2</span>)
	</span>
</div>
<div class="param">
<span class="arg">t1</span>: <span class="type">type</span> 
</div>
<div class="param">
<span class="arg">t2</span>: <span class="type">type</span> 
</div>
<div class="returns">
<span class="type">int</span>
</div>
</div>
<div class="desc">
	Recursivly checks that the two types are equal. 
</div>
</div>

<div class="docitem" id="fn:typenameequal">
<div class="proto">
<div class="function">
	<span class="id">typenameequal(<span class="arg">t1</span>,
		<span class="arg">t2</span>)
	</span>
</div>
<div class="param">
<span class="arg">t1</span>: <span class="type">type</span> 
</div>
<div class="param">
<span class="arg">t2</span>: <span class="type">type</span> 
</div>
<div class="returns">
<span class="type">int</span>
</div>
</div>
<div class="desc">
	Returns 0 if the type names are different, 1 if they are the same.
	Does not recursivly check structures but instead checks that
	they have the same name. Does check that arrays have the same length,
	functions have the same parameter and return types.
</div>
</div>

<div class="docitem" id="fn:types_with_ptrs">
<div class="proto">
<div class="function">
	<span class="id">types_with_ptrs(<span class="arg">ns</span>)
	</span>
</div>
<div class="param">
<span class="arg">ns</span>: <span class="type">namespace</span> 
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
	Print all the types containing pointers.
</div>
</div>


<h5 id="lib:snames.cqct">snames.cqct</h5>

<p>
<span class="id">snames.cqct</span> is a name space
server intended to serve to Cinquecento programs name
spaces represented by "names files" (i.e., the valid
bodies of Cinquecento <span class="val">@names</span>
forms typically stored in files with names ending in
"<span class="id">.names</span>").  It should be
executed as a stand-alone command, with the following
arguments:
</p>

<div id="inset">
<p>
snames.cqct <span class="arg">port</span> <span class="arg">rootns</span> <span class="arg">prefix</span> [<span class="arg">var</span> ...]
</p>
</div>

<p>
<span class="arg">Port</span> is the port on which the
server accepts connections (from any available network
interface).
</p>

<p>
<span class="arg">Rootns</span> is the name of the root name
space (e.g., <span class="val">c32le</span>) from which all served name spaces are extended.
</p>

<p>
<span class="arg">Prefix</span> is the path to the
directory tree in which the served names files are
accessed.  To resolve a name space name,
the <span class="arg">path</span> argument provided by
the client <span class="val">snamesns</span> operation
is appended to <span class="arg">prefix</span>.
(If <span class="arg">Prefix</span> does not end with
the character <span class="val">"/"</span>,
it is added.)
</p>

<p>
The remaining optional arguments <span class="arg">var
...</span>  are each the name of a variable that will
be bound, with value <span class="val">0</span>, in the
scope of the <span class="val">@names</span> evaluation
that is performed for each served name space.  This
allows the serving of names files that contain
references to variables, but it does not offer any
control over their values.
</p>

<p>
In the event of an error, the snames server automatically restarts.
Some diagnostics are printed to standard output.
</p>

<h5 id="lib:snamesclt.cqct">snamesclt.cqct</h5>

<p>
<span class="id">snamesclt.cqct</span> is a client interface to
the remote names server
<span class="id"><a href="#lib:snames.cqct">snames</a></span>
</p>

<div class="docitem" id="fn:setsnamesaddr">
<div class="proto">
<div class="function">
<span class="id">setsnamesaddr(<span class="arg">addr</span>)</span>
</div>
<div class="param">
<span class="arg">addr</span>: <span class="type">string</span> 
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
Address is a network address of the form 
<tt>"<em>addr</em>:<em>port</em>"</tt>, where
<span class="arg">addr</span> is an IP address or hostname and
<span class="arg">port</span> is a port number or
service name.  Updates to <span class="arg">addr</span>
the address of the snames server
contacted by the library.  The default is <span class="val">"localhost:30000</span>.
</div>
</div>

<div class="docitem" id="fn:snamesns">
<div class="proto">
<div class="function">
<span class="id">snamesns(<span class="arg">path</span>)</span>
</div>
<div class="param">
<span class="arg">path</span>: <span class="type">string</span> 
</div>
<div class="returns">
<span class="type">name space</span>
</div>
</div>
<div class="desc">
Returns the name space associated with the
name <span class="arg">path</span> on the snames
server, or <span class="id">nil</span> if there is no
associated name space.
</div>
</div>

<div class="docitem" id="fn:snamesreconnect">
<div class="proto">
<div class="function">
<span class="id">snamesreconnect()</span>
</div>
<div class="returns">
<span class="type">nil</span>
</div>
</div>
<div class="desc">
Advises the library to reset its connection to the snames server.
</div>
</div>



</div>
</div>
</div>

</div>
</body>
</html>
